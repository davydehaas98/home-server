version: "3.9"
services:
  # https://github.com/pi-hole/docker-pi-hole/
  # https://docs.pi-hole.net/
  pihole:
    image: pihole/pihole:2022.11.1
    container_name: pihole
    restart: unless-stopped
    cpus: 1
    mem_limit: 1G
    environment:
    - WEBPASSWORD=pihole
    - DNS1=1.1.1.1
    - DNS2=1.0.0.1
    volumes:
    - ${USER_DIR}/pihole:/etc/pihole
    - ${USER_DIR}/pihole/dnsmasq.d:/etc/dnsmasq.d
    # - ${USER_DIR}/pihole/pihole.log:/var/log/pihole.log
    expose:
    - 53/tcp
    - 53/udp
    # - 67/udp # act as DHCP server instead of a router
    - 80/tcp
    - 443/tcp
    cap_add:
    - NET_ADMIN
    dns:
    - 127.0.0.1
    - 1.1.1.1
    - 1.0.0.1
    labels:
    - com.centurylinklabs.watchtower.enable=true
    - diun.enable=true
    - diun.watch_repo=true
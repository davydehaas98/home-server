version: "3.8"
services:
  # https://github.com/felddy/foundryvtt-docker
  # scp -r "C:\Users\Davy\Downloads\cos\world.json" root@davydehaas.nl:/server/foundry-cos/Data/worlds/cor-cos
  foundry-cos:
    image: felddy/foundryvtt:0.8.9
    container_name: foundry-cos
    restart: unless-stopped
    cpus: 1
    mem_limit: 1G
    environment:
    - TZ=${TZ}
    - FOUNDRY_USERNAME=${FOUNDRY_USERNAME}
    - FOUNDRY_PASSWORD=${FOUNDRY_PASSWORD}
    - CONTAINER_CACHE=/server/foundry-cos/data/container_cache
    volumes:
    - /server/foundry-cos:/data
    - /server/foundry-cos/resources/app:/home/foundry/resources/app
    expose:
    - 30000
    labels:
    - com.centurylinklabs.watchtower.enable=true
    - diun.enable=true
    - diun.watch_repo=true
    - traefik.enable=true
    - traefik.http.middlewares.sslheader.headers.customrequestheaders.X-Forwarded-Proto = https
    - traefik.http.routers.foundry-cos.entrypoints=https
    - traefik.http.routers.foundry-cos.tls=true
    - traefik.http.routers.foundry-cos.rule=Host(`foundry-cos.davydehaas.nl`)
    - traefik.http.routers.foundry-cos.middlewares=chain-no-auth@file
    - traefik.http.routers.foundry-cos.service=foundry-cos
    - traefik.http.services.foundry-cos.loadbalancer.server.port=300000
    networks:
    - reverse-proxy
networks:
  reverse-proxy:
    external: true
    name: reverse-proxy_default
